import{S as B,i as S,s as U,e as m,t as x,a as _,b as o,c as w,d as L,f as C,g as u,h as R,l as y,j as q,n as v,k as E,r as j,m as z}from"./index.d9353ee8.js";import"./modulepreload-polyfill.b7f2da20.js";function A(e){let t,s,l,a,d,r,b,c,g,n,p,h,k;return{c(){t=m("div"),s=m("div"),l=m("span"),a=x(e[2]),d=_(),r=m("input"),b=_(),c=m("button"),c.textContent="GO",g=_(),n=m("iframe"),o(l,"class","netless-app-browser-status"),w(l,"loading",e[2]==="Loading"),w(l,"ready",e[2]==="Ready"),o(r,"class","netless-app-browser-url"),o(r,"autocomplete","off"),o(r,"spellcheck","false"),o(c,"class","netless-app-browser-go"),o(s,"class","netless-app-browser-omnibox"),o(n,"title","Netless App Browser"),o(n,"class","netless-app-browser-content"),o(n,"frameborder","0"),L(n.src,p=e[0])||o(n,"src",p),o(t,"class","netless-app-browser"),o(t,"data-kind","browser")},m(i,f){C(i,t,f),u(t,s),u(s,l),u(l,a),u(s,d),u(s,r),R(r,e[1]),u(s,b),u(s,c),u(t,g),u(t,n),h||(k=[y(r,"input",e[5]),y(r,"keypress",e[6]),y(c,"click",e[4]),y(n,"load",e[3])],h=!0)},p(i,[f]){f&4&&q(a,i[2]),f&4&&w(l,"loading",i[2]==="Loading"),f&4&&w(l,"ready",i[2]==="Ready"),f&2&&r.value!==i[1]&&R(r,i[1]),f&1&&!L(n.src,p=i[0])&&o(n,"src",p)},i:v,o:v,d(i){i&&E(t),h=!1,j(k)}}}function D(e,t,s){const l=z();let{url:a="about:blank"}=t,{dummyURL:d=a}=t,r="Ready";function b(){s(2,r="Ready")}function c(){s(0,a=d),s(2,r="Loading")}function g(){d=this.value,s(1,d)}const n=p=>p.key==="Enter"&&c();return e.$$set=p=>{"url"in p&&s(0,a=p.url),"dummyURL"in p&&s(1,d=p.dummyURL)},e.$$.update=()=>{e.$$.dirty&1&&l("update",a)},[a,d,r,b,c,g,n]}class G extends B{constructor(t){super(),S(this,t,D,A,U,{url:0,dummyURL:1})}}const N=`.netless-app-browser{width:100%;height:100%;display:flex;flex-flow:column nowrap}.telebox-color-scheme-dark .netless-app-browser{color-scheme:dark}.netless-app-browser-omnibox{padding:2px 4px;display:flex;align-items:center;gap:4px}.netless-app-browser-status{width:5em;font-size:x-small;text-align:center}.netless-app-browser-status.loading{color:gray}.netless-app-browser-status.ready{color:green}.netless-app-browser-url{flex-grow:1}.netless-app-browser-go{padding:1px 12px}.netless-app-browser-content{display:block;flex-grow:1}
`,H={kind:"Browser",setup(e){const t=e.box;t.mountStyles(N);const s=new G({target:t.$content,props:{url:e.storage.state.url||"about:blank"}});s.$on("update",({detail:a})=>{e.storage.setState({url:a})});const l=e.storage.addStateChangedListener(()=>{const{url:a}=e.storage.state;s.$set({url:a,dummyURL:a})});e.emitter.on("destroy",()=>{console.log("[Browser]: destroy"),l(),s.$destroy()})}};export{H as default};
